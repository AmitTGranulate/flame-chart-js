!function(){"use strict";function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function t(t,e){var n,r=Object.keys(t);return Object.getOwnPropertySymbols&&(n=Object.getOwnPropertySymbols(t),e&&(n=n.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),r.push.apply(r,n)),r}function i(r){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{};e%2?t(Object(i),!0).forEach(function(e){var t,n;t=r,e=i[n=e],n in t?Object.defineProperty(t,n,{value:e,enumerable:!0,configurable:!0,writable:!0}):t[n]=e}):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(i)):t(Object(i)).forEach(function(e){Object.defineProperty(r,e,Object.getOwnPropertyDescriptor(i,e))})}return r}function o(e){return(o=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function a(e,t){return(a=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function s(e,t){if(null==e)return{};var n,r=function(e,t){if(null==e)return{};for(var n,r={},i=Object.keys(e),o=0;o<i.length;o++)n=i[o],0<=t.indexOf(n)||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols)for(var i=Object.getOwnPropertySymbols(e),o=0;o<i.length;o++)n=i[o],0<=t.indexOf(n)||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n]);return r}function d(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function h(n){var r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}();return function(){var e,t=o(n);return e=r?(e=o(this).constructor,Reflect.construct(t,arguments,e)):t.apply(this,arguments),t=this,!(e=e)||"object"!=typeof e&&"function"!=typeof e?d(t):e}}function l(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,i=!1,o=void 0;try{for(var a,s=e[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(e){i=!0,o=e}finally{try{r||null==s.return||s.return()}finally{if(i)throw o}}return n}(e,t)||u(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function f(e){return function(e){if(Array.isArray(e))return c(e)}(e)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||u(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function u(e,t){if(e){if("string"==typeof e)return c(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Map"===(n="Object"===n&&e.constructor?e.constructor.name:n)||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?c(e,t):void 0}}function c(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function e(e,t){return e(t={exports:{}},t.exports),t.exports}var v={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]},m=e(function(e){var a=Array.prototype.concat,s=Array.prototype.slice,t=e.exports=function(e){for(var t,n=[],r=0,i=e.length;r<i;r++){var o=e[r];(t=o)&&"string"!=typeof t&&(t instanceof Array||Array.isArray(t)||0<=t.length&&(t.splice instanceof Function||Object.getOwnPropertyDescriptor(t,t.length-1)&&"String"!==t.constructor.name))?n=a.call(n,s.call(o)):n.push(o)}return n};t.wrap=function(e){return function(){return e(t(arguments))}}}),g=e(function(e){var t,n={};for(t in v)v.hasOwnProperty(t)&&(n[v[t]]=t);var r=e.exports={to:{},get:{}};function a(e,t,n){return Math.min(Math.max(t,e),n)}function i(e){e=e.toString(16).toUpperCase();return e.length<2?"0"+e:e}r.get=function(e){var t,n;switch(e.substring(0,3).toLowerCase()){case"hsl":t=r.get.hsl(e),n="hsl";break;case"hwb":t=r.get.hwb(e),n="hwb";break;default:t=r.get.rgb(e),n="rgb"}return t?{model:n,value:t}:null},r.get.rgb=function(e){if(!e)return null;var t,n,r,i=[0,0,0,1];if(t=e.match(/^#([a-f0-9]{6})([a-f0-9]{2})?$/i)){for(r=t[2],t=t[1],n=0;n<3;n++){var o=2*n;i[n]=parseInt(t.slice(o,2+o),16)}r&&(i[3]=parseInt(r,16)/255)}else if(t=e.match(/^#([a-f0-9]{3,4})$/i)){for(r=(t=t[1])[3],n=0;n<3;n++)i[n]=parseInt(t[n]+t[n],16);r&&(i[3]=parseInt(r+r,16)/255)}else if(t=e.match(/^rgba?\(\s*([+-]?\d+)\s*,\s*([+-]?\d+)\s*,\s*([+-]?\d+)\s*(?:,\s*([+-]?[\d\.]+)\s*)?\)$/)){for(n=0;n<3;n++)i[n]=parseInt(t[n+1],0);t[4]&&(i[3]=parseFloat(t[4]))}else{if(!(t=e.match(/^rgba?\(\s*([+-]?[\d\.]+)\%\s*,\s*([+-]?[\d\.]+)\%\s*,\s*([+-]?[\d\.]+)\%\s*(?:,\s*([+-]?[\d\.]+)\s*)?\)$/)))return(t=e.match(/(\D+)/))?"transparent"===t[1]?[0,0,0,0]:(i=v[t[1]])?(i[3]=1,i):null:null;for(n=0;n<3;n++)i[n]=Math.round(2.55*parseFloat(t[n+1]));t[4]&&(i[3]=parseFloat(t[4]))}for(n=0;n<3;n++)i[n]=a(i[n],0,255);return i[3]=a(i[3],0,1),i},r.get.hsl=function(e){if(!e)return null;var t=e.match(/^hsla?\(\s*([+-]?(?:\d{0,3}\.)?\d+)(?:deg)?\s*,\s*([+-]?[\d\.]+)%\s*,\s*([+-]?[\d\.]+)%\s*(?:,\s*([+-]?[\d\.]+)\s*)?\)$/);if(t){e=parseFloat(t[4]);return[(parseFloat(t[1])+360)%360,a(parseFloat(t[2]),0,100),a(parseFloat(t[3]),0,100),a(isNaN(e)?1:e,0,1)]}return null},r.get.hwb=function(e){if(!e)return null;var t=e.match(/^hwb\(\s*([+-]?\d{0,3}(?:\.\d+)?)(?:deg)?\s*,\s*([+-]?[\d\.]+)%\s*,\s*([+-]?[\d\.]+)%\s*(?:,\s*([+-]?[\d\.]+)\s*)?\)$/);if(t){e=parseFloat(t[4]);return[(parseFloat(t[1])%360+360)%360,a(parseFloat(t[2]),0,100),a(parseFloat(t[3]),0,100),a(isNaN(e)?1:e,0,1)]}return null},r.to.hex=function(){var e=m(arguments);return"#"+i(e[0])+i(e[1])+i(e[2])+(e[3]<1?i(Math.round(255*e[3])):"")},r.to.rgb=function(){var e=m(arguments);return e.length<4||1===e[3]?"rgb("+Math.round(e[0])+", "+Math.round(e[1])+", "+Math.round(e[2])+")":"rgba("+Math.round(e[0])+", "+Math.round(e[1])+", "+Math.round(e[2])+", "+e[3]+")"},r.to.rgb.percent=function(){var e=m(arguments),t=Math.round(e[0]/255*100),n=Math.round(e[1]/255*100),r=Math.round(e[2]/255*100);return e.length<4||1===e[3]?"rgb("+t+"%, "+n+"%, "+r+"%)":"rgba("+t+"%, "+n+"%, "+r+"%, "+e[3]+")"},r.to.hsl=function(){var e=m(arguments);return e.length<4||1===e[3]?"hsl("+e[0]+", "+e[1]+"%, "+e[2]+"%)":"hsla("+e[0]+", "+e[1]+"%, "+e[2]+"%, "+e[3]+")"},r.to.hwb=function(){var e=m(arguments),t="";return 4<=e.length&&1!==e[3]&&(t=", "+e[3]),"hwb("+e[0]+", "+e[1]+"%, "+e[2]+"%"+t+")"},r.to.keyword=function(e){return n[e.slice(0,3)]}});g.to,g.get;var p=e(function(e){var t,s={};for(t in v)v.hasOwnProperty(t)&&(s[v[t]]=t);var n,i=e.exports={rgb:{channels:3,labels:"rgb"},hsl:{channels:3,labels:"hsl"},hsv:{channels:3,labels:"hsv"},hwb:{channels:3,labels:"hwb"},cmyk:{channels:4,labels:"cmyk"},xyz:{channels:3,labels:"xyz"},lab:{channels:3,labels:"lab"},lch:{channels:3,labels:"lch"},hex:{channels:1,labels:["hex"]},keyword:{channels:1,labels:["keyword"]},ansi16:{channels:1,labels:["ansi16"]},ansi256:{channels:1,labels:["ansi256"]},hcg:{channels:3,labels:["h","c","g"]},apple:{channels:3,labels:["r16","g16","b16"]},gray:{channels:1,labels:["gray"]}};for(n in i)if(i.hasOwnProperty(n)){if(!("channels"in i[n]))throw new Error("missing channels property: "+n);if(!("labels"in i[n]))throw new Error("missing channel labels property: "+n);if(i[n].labels.length!==i[n].channels)throw new Error("channel and label counts mismatch: "+n);var r=i[n].channels,o=i[n].labels;delete i[n].channels,delete i[n].labels,Object.defineProperty(i[n],"channels",{value:r}),Object.defineProperty(i[n],"labels",{value:o})}i.rgb.hsl=function(e){var t,n=e[0]/255,r=e[1]/255,i=e[2]/255,o=Math.min(n,r,i),a=Math.max(n,r,i),e=a-o;return a===o?t=0:n===a?t=(r-i)/e:r===a?t=2+(i-n)/e:i===a&&(t=4+(n-r)/e),(t=Math.min(60*t,360))<0&&(t+=360),r=(o+a)/2,[t,100*(a===o?0:r<=.5?e/(a+o):e/(2-a-o)),100*r]},i.rgb.hsv=function(e){var t,n,r,i=e[0]/255,o=e[1]/255,a=e[2]/255,s=Math.max(i,o,a),h=s-Math.min(i,o,a),l=function(e){return(s-e)/6/h+.5};return 0==h?n=r=0:(r=h/s,t=l(i),e=l(o),l=l(a),i===s?n=l-e:o===s?n=1/3+t-l:a===s&&(n=2/3+e-t),n<0?n+=1:1<n&&--n),[360*n,100*r,100*s]},i.rgb.hwb=function(e){var t=e[0],n=e[1],r=e[2];return[i.rgb.hsl(e)[0],100*(1/255*Math.min(t,Math.min(n,r))),100*(r=1-1/255*Math.max(t,Math.max(n,r)))]},i.rgb.cmyk=function(e){var t=e[0]/255,n=e[1]/255,r=e[2]/255,e=Math.min(1-t,1-n,1-r);return[100*((1-t-e)/(1-e)||0),100*((1-n-e)/(1-e)||0),100*((1-r-e)/(1-e)||0),100*e]},i.rgb.keyword=function(e){var t=s[e];if(t)return t;var n,r,i,o,a=1/0;for(r in v)v.hasOwnProperty(r)&&(o=v[r],i=e,o=o,(o=Math.pow(i[0]-o[0],2)+Math.pow(i[1]-o[1],2)+Math.pow(i[2]-o[2],2))<a&&(a=o,n=r));return n},i.keyword.rgb=function(e){return v[e]},i.rgb.xyz=function(e){var t=e[0]/255,n=e[1]/255,e=e[2]/255;return[100*(.4124*(t=.04045<t?Math.pow((t+.055)/1.055,2.4):t/12.92)+.3576*(n=.04045<n?Math.pow((n+.055)/1.055,2.4):n/12.92)+.1805*(e=.04045<e?Math.pow((e+.055)/1.055,2.4):e/12.92)),100*(.2126*t+.7152*n+.0722*e),100*(.0193*t+.1192*n+.9505*e)]},i.rgb.lab=function(e){var t=i.rgb.xyz(e),n=t[0],e=t[1],t=t[2];return e/=100,t/=108.883,n=.008856<(n/=95.047)?Math.pow(n,1/3):7.787*n+16/116,[116*(e=.008856<e?Math.pow(e,1/3):7.787*e+16/116)-16,500*(n-e),200*(e-(t=.008856<t?Math.pow(t,1/3):7.787*t+16/116))]},i.hsl.rgb=function(e){var t,n,r=e[0]/360,i=e[1]/100,e=e[2]/100;if(0==i)return[n=255*e,n,n];for(var o,a=2*e-(o=e<.5?e*(1+i):e+i-e*i),s=[0,0,0],h=0;h<3;h++)(t=r+1/3*-(h-1))<0&&t++,1<t&&t--,n=6*t<1?a+6*(o-a)*t:2*t<1?o:3*t<2?a+(o-a)*(2/3-t)*6:a,s[h]=255*n;return s},i.hsl.hsv=function(e){var t=e[0],n=e[1]/100,r=e[2]/100,i=n,e=Math.max(r,.01);return n*=(r*=2)<=1?r:2-r,i*=e<=1?e:2-e,[t,100*(0==r?2*i/(e+i):2*n/(r+n)),100*((r+n)/2)]},i.hsv.rgb=function(e){var t=e[0]/60,n=e[1]/100,r=e[2]/100,e=Math.floor(t)%6,t=t-Math.floor(t),i=255*r*(1-n),o=255*r*(1-n*t),a=255*r*(1-n*(1-t));switch(r*=255,e){case 0:return[r,a,i];case 1:return[o,r,i];case 2:return[i,r,a];case 3:return[i,o,r];case 4:return[a,i,r];case 5:return[r,i,o]}},i.hsv.hsl=function(e){var t=e[0],n=e[1]/100,r=e[2]/100,i=Math.max(r,.01),e=(2-n)*r,r=(2-n)*i,i=n*i;return[t,100*((i/=r<=1?r:2-r)||0),100*(e/=2)]},i.hwb.rgb=function(e){var t,n,r,i,o,a=e[0]/360,s=e[1]/100,h=e[2]/100,e=s+h;switch(1<e&&(s/=e,h/=e),a=6*a-(e=Math.floor(6*a)),n=s+(a=0!=(1&e)?1-a:a)*((t=1-h)-s),e){default:case 6:case 0:r=t,i=n,o=s;break;case 1:r=n,i=t,o=s;break;case 2:r=s,i=t,o=n;break;case 3:r=s,i=n,o=t;break;case 4:r=n,i=s,o=t;break;case 5:r=t,i=s,o=n}return[255*r,255*i,255*o]},i.cmyk.rgb=function(e){var t=e[0]/100,n=e[1]/100,r=e[2]/100,e=e[3]/100;return[255*(1-Math.min(1,t*(1-e)+e)),255*(1-Math.min(1,n*(1-e)+e)),255*(1-Math.min(1,r*(1-e)+e))]},i.xyz.rgb=function(e){var t=e[0]/100,n=e[1]/100,r=e[2]/100,i=3.2406*t+-1.5372*n+-.4986*r,e=-.9689*t+1.8758*n+.0415*r,r=.0557*t+-.204*n+1.057*r;return i=.0031308<i?1.055*Math.pow(i,1/2.4)-.055:12.92*i,e=.0031308<e?1.055*Math.pow(e,1/2.4)-.055:12.92*e,r=.0031308<r?1.055*Math.pow(r,1/2.4)-.055:12.92*r,[255*(i=Math.min(Math.max(0,i),1)),255*(e=Math.min(Math.max(0,e),1)),255*(r=Math.min(Math.max(0,r),1))]},i.xyz.lab=function(e){var t=e[0],n=e[1],e=e[2];return n/=100,e/=108.883,t=.008856<(t/=95.047)?Math.pow(t,1/3):7.787*t+16/116,[116*(n=.008856<n?Math.pow(n,1/3):7.787*n+16/116)-16,500*(t-n),200*(n-(e=.008856<e?Math.pow(e,1/3):7.787*e+16/116))]},i.lab.xyz=function(e){var t=(e[0]+16)/116,n=e[1]/500+t,r=t-e[2]/200,i=Math.pow(t,3),o=Math.pow(n,3),e=Math.pow(r,3);return t=.008856<i?i:(t-16/116)/7.787,n=.008856<o?o:(n-16/116)/7.787,r=.008856<e?e:(r-16/116)/7.787,[n*=95.047,t*=100,r*=108.883]},i.lab.lch=function(e){var t=e[0],n=e[1],r=e[2],e=360*Math.atan2(r,n)/2/Math.PI;return e<0&&(e+=360),[t,Math.sqrt(n*n+r*r),e]},i.lch.lab=function(e){var t=e[0],n=e[1],e=e[2]/360*2*Math.PI;return[t,n*Math.cos(e),n*Math.sin(e)]},i.rgb.ansi16=function(e){var t=e[0],n=e[1],r=e[2],e=1 in arguments?arguments[1]:i.rgb.hsv(e)[2];if(0===(e=Math.round(e/50)))return 30;t=30+(Math.round(r/255)<<2|Math.round(n/255)<<1|Math.round(t/255));return 2===e&&(t+=60),t},i.hsv.ansi16=function(e){return i.rgb.ansi16(i.hsv.rgb(e),e[2])},i.rgb.ansi256=function(e){var t=e[0],n=e[1],e=e[2];return t===n&&n===e?t<8?16:248<t?231:Math.round((t-8)/247*24)+232:16+36*Math.round(t/255*5)+6*Math.round(n/255*5)+Math.round(e/255*5)},i.ansi16.rgb=function(e){var t=e%10;if(0===t||7===t)return 50<e&&(t+=3.5),[t=t/10.5*255,t,t];e=.5*(1+~~(50<e));return[(1&t)*e*255,(t>>1&1)*e*255,(t>>2&1)*e*255]},i.ansi256.rgb=function(e){if(232<=e){var t=10*(e-232)+8;return[t,t,t]}return e-=16,[Math.floor(e/36)/5*255,Math.floor((e=e%36)/6)/5*255,e%6/5*255]},i.rgb.hex=function(e){e=(((255&Math.round(e[0]))<<16)+((255&Math.round(e[1]))<<8)+(255&Math.round(e[2]))).toString(16).toUpperCase();return"000000".substring(e.length)+e},i.hex.rgb=function(e){var t=e.toString(16).match(/[a-f0-9]{6}|[a-f0-9]{3}/i);if(!t)return[0,0,0];e=t[0];3===t[0].length&&(e=e.split("").map(function(e){return e+e}).join(""));e=parseInt(e,16);return[e>>16&255,e>>8&255,255&e]},i.rgb.hcg=function(e){var t=e[0]/255,n=e[1]/255,r=e[2]/255,i=Math.max(Math.max(t,n),r),o=Math.min(Math.min(t,n),r),e=i-o,o=e<1?o/(1-e):0,n=e<=0?0:i===t?(n-r)/e%6:i===n?2+(r-t)/e:4+(t-n)/e+4;return n/=6,[360*(n%=1),100*e,100*o]},i.hsl.hcg=function(e){var t=e[1]/100,n=e[2]/100,r=1,i=0;return(r=n<.5?2*t*n:2*t*(1-n))<1&&(i=(n-.5*r)/(1-r)),[e[0],100*r,100*i]},i.hsv.hcg=function(e){var t=e[1]/100,n=e[2]/100,t=t*n,n=t<1?(n-t)/(1-t):0;return[e[0],100*t,100*n]},i.hcg.rgb=function(e){var t=e[0]/360,n=e[1]/100,r=e[2]/100;if(0==n)return[255*r,255*r,255*r];var i=[0,0,0],e=t%1*6,o=e%1,a=1-o;switch(Math.floor(e)){case 0:i[0]=1,i[1]=o,i[2]=0;break;case 1:i[0]=a,i[1]=1,i[2]=0;break;case 2:i[0]=0,i[1]=1,i[2]=o;break;case 3:i[0]=0,i[1]=a,i[2]=1;break;case 4:i[0]=o,i[1]=0,i[2]=1;break;default:i[0]=1,i[1]=0,i[2]=a}return t=(1-n)*r,[255*(n*i[0]+t),255*(n*i[1]+t),255*(n*i[2]+t)]},i.hcg.hsv=function(e){var t=e[1]/100,n=t+e[2]/100*(1-t),t=0<n?t/n:0;return[e[0],100*t,100*n]},i.hcg.hsl=function(e){var t=e[1]/100,n=e[2]/100*(1-t)+.5*t,r=0;return 0<n&&n<.5?r=t/(2*n):.5<=n&&n<1&&(r=t/(2*(1-n))),[e[0],100*r,100*n]},i.hcg.hwb=function(e){var t=e[1]/100,n=t+e[2]/100*(1-t);return[e[0],100*(n-t),100*(1-n)]},i.hwb.hcg=function(e){var t=e[1]/100,n=1-e[2]/100,t=n-t,n=t<1?(n-t)/(1-t):0;return[e[0],100*t,100*n]},i.apple.rgb=function(e){return[e[0]/65535*255,e[1]/65535*255,e[2]/65535*255]},i.rgb.apple=function(e){return[e[0]/255*65535,e[1]/255*65535,e[2]/255*65535]},i.gray.rgb=function(e){return[e[0]/100*255,e[0]/100*255,e[0]/100*255]},i.gray.hsl=i.gray.hsv=function(e){return[0,0,e[0]]},i.gray.hwb=function(e){return[0,100,e[0]]},i.gray.cmyk=function(e){return[0,0,0,e[0]]},i.gray.lab=function(e){return[e[0],0,0]},i.gray.hex=function(e){e=255&Math.round(e[0]/100*255),e=((e<<16)+(e<<8)+e).toString(16).toUpperCase();return"000000".substring(e.length)+e},i.rgb.gray=function(e){return[(e[0]+e[1]+e[2])/3/255*100]}});function y(e){var t=function(){for(var e={},t=Object.keys(p),n=t.length,r=0;r<n;r++)e[t[r]]={distance:-1,parent:null};return e}(),n=[e];for(t[e].distance=0;n.length;)for(var r=n.pop(),i=Object.keys(p[r]),o=i.length,a=0;a<o;a++){var s=i[a],h=t[s];-1===h.distance&&(h.distance=t[r].distance+1,h.parent=r,n.unshift(s))}return t}function b(e,t){for(var n=[t[e].parent,e],r=p[t[e].parent][e],i=t[e].parent;t[i].parent;)n.unshift(t[i].parent),r=function(t,n){return function(e){return n(t(e))}}(p[t[i].parent][i],r),i=t[i].parent;return r.conversion=n,r}p.rgb,p.hsl,p.hsv,p.hwb,p.cmyk,p.xyz,p.lab,p.lch,p.hex,p.keyword,p.ansi16,p.ansi256,p.hcg,p.apple,p.gray;var w={};function x(t){function e(e){return null==e?e:(1<arguments.length&&(e=Array.prototype.slice.call(arguments)),t(e))}return"conversion"in t&&(e.conversion=t.conversion),e}function k(i){function e(e){if(null==e)return e;1<arguments.length&&(e=Array.prototype.slice.call(arguments));var t=i(e);if("object"==typeof t)for(var n=t.length,r=0;r<n;r++)t[r]=Math.round(t[r]);return t}return"conversion"in i&&(e.conversion=i.conversion),e}Object.keys(p).forEach(function(n){w[n]={},Object.defineProperty(w[n],"channels",{value:p[n].channels}),Object.defineProperty(w[n],"labels",{value:p[n].labels});var r=function(e){for(var t=y(e),n={},r=Object.keys(t),i=r.length,o=0;o<i;o++){var a=r[o];null!==t[a].parent&&(n[a]=b(a,t))}return n}(n);Object.keys(r).forEach(function(e){var t=r[e];w[n][e]=k(t),w[n][e].raw=x(t)})});var M=w,R=[].slice,T=["keyword","gray","hex"],C={};Object.keys(M).forEach(function(e){C[R.call(M[e].labels).sort().join("")]=e});var E={};function P(e,t){if(!(this instanceof P))return new P(e,t);if((t=t&&t in T?null:t)&&!(t in M))throw new Error("Unknown model: "+t);if(null==e)this.model="rgb",this.color=[0,0,0],this.valpha=1;else if(e instanceof P)this.model=e.model,this.color=e.color.slice(),this.valpha=e.valpha;else if("string"==typeof e){var n=g.get(e);if(null===n)throw new Error("Unable to parse color from string: "+e);this.model=n.model,r=M[this.model].channels,this.color=n.value.slice(0,r),this.valpha="number"==typeof n.value[r]?n.value[r]:1}else if(e.length){this.model=t||"rgb";var r=M[this.model].channels,i=R.call(e,0,r);this.color=L(i,r),this.valpha="number"==typeof e[r]?e[r]:1}else if("number"==typeof e)e&=16777215,this.model="rgb",this.color=[e>>16&255,e>>8&255,255&e],this.valpha=1;else{this.valpha=1;i=Object.keys(e);"alpha"in e&&(i.splice(i.indexOf("alpha"),1),this.valpha="number"==typeof e.alpha?e.alpha:0);i=i.sort().join("");if(!(i in C))throw new Error("Unable to parse color from object: "+JSON.stringify(e));this.model=C[i];for(var o=M[this.model].labels,a=[],s=0;s<o.length;s++)a.push(e[o[s]]);this.color=L(a)}if(E[this.model])for(r=M[this.model].channels,s=0;s<r;s++){var h=E[this.model][s];h&&(this.color[s]=h(this.color[s]))}this.valpha=Math.max(0,Math.min(1,this.valpha)),Object.freeze&&Object.freeze(this)}function n(n,r,i){return(n=Array.isArray(n)?n:[n]).forEach(function(e){(E[e]||(E[e]=[]))[r]=i}),n=n[0],function(e){var t;return arguments.length?(i&&(e=i(e)),(t=this[n]()).color[r]=e,t):(t=this[n]().color[r],t=i?i(t):t)}}function O(t){return function(e){return Math.max(0,Math.min(t,e))}}function L(e,t){for(var n=0;n<t;n++)"number"!=typeof e[n]&&(e[n]=0);return e}P.prototype={toString:function(){return this.string()},toJSON:function(){return this[this.model]()},string:function(e){var t=this.model in g.to?this:this.rgb(),e=1===(t=t.round("number"==typeof e?e:1)).valpha?t.color:t.color.concat(this.valpha);return g.to[t.model](e)},percentString:function(e){e=this.rgb().round("number"==typeof e?e:1),e=1===e.valpha?e.color:e.color.concat(this.valpha);return g.to.rgb.percent(e)},array:function(){return 1===this.valpha?this.color.slice():this.color.concat(this.valpha)},object:function(){for(var e={},t=M[this.model].channels,n=M[this.model].labels,r=0;r<t;r++)e[n[r]]=this.color[r];return 1!==this.valpha&&(e.alpha=this.valpha),e},unitArray:function(){var e=this.rgb().color;return e[0]/=255,e[1]/=255,e[2]/=255,1!==this.valpha&&e.push(this.valpha),e},unitObject:function(){var e=this.rgb().object();return e.r/=255,e.g/=255,e.b/=255,1!==this.valpha&&(e.alpha=this.valpha),e},round:function(e){return e=Math.max(e||0,0),new P(this.color.map((n=e,function(e){return t=n,Number(e.toFixed(t));var t})).concat(this.valpha),this.model);var n},alpha:function(e){return arguments.length?new P(this.color.concat(Math.max(0,Math.min(1,e))),this.model):this.valpha},red:n("rgb",0,O(255)),green:n("rgb",1,O(255)),blue:n("rgb",2,O(255)),hue:n(["hsl","hsv","hsl","hwb","hcg"],0,function(e){return(e%360+360)%360}),saturationl:n("hsl",1,O(100)),lightness:n("hsl",2,O(100)),saturationv:n("hsv",1,O(100)),value:n("hsv",2,O(100)),chroma:n("hcg",1,O(100)),gray:n("hcg",2,O(100)),white:n("hwb",1,O(100)),wblack:n("hwb",2,O(100)),cyan:n("cmyk",0,O(100)),magenta:n("cmyk",1,O(100)),yellow:n("cmyk",2,O(100)),black:n("cmyk",3,O(100)),x:n("xyz",0,O(100)),y:n("xyz",1,O(100)),z:n("xyz",2,O(100)),l:n("lab",0,O(100)),a:n("lab",1),b:n("lab",2),keyword:function(e){return arguments.length?new P(e):M[this.model].keyword(this.color)},hex:function(e){return arguments.length?new P(e):g.to.hex(this.rgb().round().color)},rgbNumber:function(){var e=this.rgb().color;return(255&e[0])<<16|(255&e[1])<<8|255&e[2]},luminosity:function(){for(var e=this.rgb().color,t=[],n=0;n<e.length;n++){var r=e[n]/255;t[n]=r<=.03928?r/12.92:Math.pow((.055+r)/1.055,2.4)}return.2126*t[0]+.7152*t[1]+.0722*t[2]},contrast:function(e){var t=this.luminosity(),e=e.luminosity();return e<t?(t+.05)/(e+.05):(e+.05)/(t+.05)},level:function(e){e=this.contrast(e);return 7.1<=e?"AAA":4.5<=e?"AA":""},isDark:function(){var e=this.rgb().color;return(299*e[0]+587*e[1]+114*e[2])/1e3<128},isLight:function(){return!this.isDark()},negate:function(){for(var e=this.rgb(),t=0;t<3;t++)e.color[t]=255-e.color[t];return e},lighten:function(e){var t=this.hsl();return t.color[2]+=t.color[2]*e,t},darken:function(e){var t=this.hsl();return t.color[2]-=t.color[2]*e,t},saturate:function(e){var t=this.hsl();return t.color[1]+=t.color[1]*e,t},desaturate:function(e){var t=this.hsl();return t.color[1]-=t.color[1]*e,t},whiten:function(e){var t=this.hwb();return t.color[1]+=t.color[1]*e,t},blacken:function(e){var t=this.hwb();return t.color[2]+=t.color[2]*e,t},grayscale:function(){var e=this.rgb().color,e=.3*e[0]+.59*e[1]+.11*e[2];return P.rgb(e,e,e)},fade:function(e){return this.alpha(this.valpha-this.valpha*e)},opaquer:function(e){return this.alpha(this.valpha+this.valpha*e)},rotate:function(e){var t=this.hsl(),n=t.color[0];return n=(n=(n+e)%360)<0?360+n:n,t.color[0]=n,t},mix:function(e,t){if(!e||!e.rgb)throw new Error('Argument to "mix" was not a Color instance, but rather an instance of '+typeof e);var n=e.rgb(),r=this.rgb(),i=void 0===t?.5:t,e=2*i-1,t=n.alpha()-r.alpha(),e=(1+(e*t==-1?e:(e+t)/(1+e*t)))/2,t=1-e;return P.rgb(e*n.red()+t*r.red(),e*n.green()+t*r.green(),e*n.blue()+t*r.blue(),n.alpha()*i+r.alpha()*(1-i))}},Object.keys(M).forEach(function(n){var r;-1===T.indexOf(n)&&(r=M[n].channels,P.prototype[n]=function(){if(this.model===n)return new P(this);if(arguments.length)return new P(arguments,n);var e,t="number"==typeof arguments[r]?r:this.valpha;return new P((e=M[this.model][n].raw(this.color),(Array.isArray(e)?e:[e]).concat(t)),n)},P[n]=function(e){return new P(e="number"==typeof e?L(R.call(arguments),r):e,n)})});var S=P;function j(){}function z(){z.init.call(this)}function A(e){return void 0===e._maxListeners?z.defaultMaxListeners:e._maxListeners}function H(e,t,n,r){var i,o;if("function"!=typeof n)throw new TypeError('"listener" argument must be a function');return(i=e._events)?(i.newListener&&(e.emit("newListener",t,n.listener||n),i=e._events),o=i[t]):(i=e._events=new j,e._eventsCount=0),o?("function"==typeof o?o=i[t]=r?[n,o]:[o,n]:r?o.unshift(n):o.push(n),o.warned||(r=A(e))&&0<r&&o.length>r&&(o.warned=!0,(r=new Error("Possible EventEmitter memory leak detected. "+o.length+" "+t+" listeners added. Use emitter.setMaxListeners() to increase limit")).name="MaxListenersExceededWarning",r.emitter=e,r.type=t,r.count=o.length,r=r,"function"==typeof console.warn?console.warn(r):console.log(r))):(o=i[t]=n,++e._eventsCount),e}function D(e,t,n){var r=!1;function i(){e.removeListener(t,i),r||(r=!0,n.apply(e,arguments))}return i.listener=n,i}function F(e){var t=this._events;if(t){e=t[e];if("function"==typeof e)return 1;if(e)return e.length}return 0}function _(e,t){for(var n=new Array(t);t--;)n[t]=e[t];return n}function I(e,t){var n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:0;e.forEach(function(e){t(e,n),e.children&&I(e.children,t,n+1)})}function B(e,t,n){return e.start<n&&e.end>t||e.start>t&&e.end<n}function N(e,i,o,a){var s=null,h=null,l=0;return e.reduce(function(e,t){t=t.nodes;h=s=null,l=0;var n=function(e,t){var n;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(n=u(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,t=function(){};return{s:t,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:t}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,o=!0,a=!1;return{s:function(){n=e[Symbol.iterator]()},n:function(){var e=n.next();return o=e.done,e},e:function(e){a=!0,i=e},f:function(){try{o||null==n.return||n.return()}finally{if(a)throw i}}}}(t);try{for(n.s();!(r=n.n()).done;){var r=r.value;B(r.node,o,a)&&(s&&!h||h&&(r.node.start-(h.node.start+h.node.duration))*i<.5&&r.node.duration*i<1&&h.node.duration*i<1?(s[l]=r,l++):(s=[r],l=1,e.push(s)),h=r)}}catch(e){n.e(e)}finally{n.f()}return e},[]).map(function(e){var t,n=e[0],r=n.node,i=n.level,n=(n=(t=e)[0].node,(t=t[t.length-1].node).start+t.duration-n.start);return{start:r.start,end:r.start+n,duration:n,type:r.type,color:r.color,level:i,nodes:e}})}function Q(r,e,i,o){var t=K(e),a=e-(t=t||(e?1:0)),s=i,h=0;return new Array(t).fill(null).map(function(){var e,t=s+h+K(o-h-(s-i)),n=K(o-(t-i),1);return h=n,s=t,a&&r&&(e=Q(r-1,a,t,n),a-=e.length),{name:function(e){var t="qwertyuiopasdfghjklzxcvbnmQWERTYUIOPASDFGHJKLZXCVBNM",e=K(e,1<arguments.length&&void 0!==arguments[1]?arguments[1]:4);return Array(e).fill(null).map(function(){return t[K(t.length)]}).join("")}(10),start:t,duration:n,children:e}})}function U(){return Q(ce,ue,le,he)}function X(){var e=window.getComputedStyle(G,null);return[parseInt(e.getPropertyValue("width")),parseInt(e.getPropertyValue("height"))-4]}j.prototype=Object.create(null),(z.EventEmitter=z).usingDomains=!1,z.prototype.domain=void 0,z.prototype._events=void 0,z.prototype._maxListeners=void 0,z.defaultMaxListeners=10,z.init=function(){this.domain=null,z.usingDomains&&(void 0).active,this._events&&this._events!==Object.getPrototypeOf(this)._events||(this._events=new j,this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},z.prototype.setMaxListeners=function(e){if("number"!=typeof e||e<0||isNaN(e))throw new TypeError('"n" argument must be a positive number');return this._maxListeners=e,this},z.prototype.getMaxListeners=function(){return A(this)},z.prototype.emit=function(e){var t,n,r,i="error"===e,o=this._events;if(o)i=i&&null==o.error;else if(!i)return!1;if(a=this.domain,i){if(i=arguments[1],a)return(i=i||new Error('Uncaught, unspecified "error" event')).domainEmitter=this,i.domain=a,i.domainThrown=!1,a.emit("error",i),!1;if(i instanceof Error)throw i;var a=new Error('Uncaught, unspecified "error" event. ('+i+")");throw a.context=i,a}if(!(t=o[e]))return!1;var s,h="function"==typeof t;switch(s=arguments.length){case 1:!function(e,t){if(h)e.call(t);else for(var n=e.length,r=_(e,n),i=0;i<n;++i)r[i].call(t)}(t,this);break;case 2:!function(e,t,n,r){if(t)e.call(n,r);else for(var i=e.length,o=_(e,i),a=0;a<i;++a)o[a].call(n,r)}(t,h,this,arguments[1]);break;case 3:!function(e,t,n,r,i){if(t)e.call(n,r,i);else for(var o=e.length,a=_(e,o),s=0;s<o;++s)a[s].call(n,r,i)}(t,h,this,arguments[1],arguments[2]);break;case 4:!function(e,t,n,r,i,o){if(t)e.call(n,r,i,o);else for(var a=e.length,s=_(e,a),h=0;h<a;++h)s[h].call(n,r,i,o)}(t,h,this,arguments[1],arguments[2],arguments[3]);break;default:for(n=new Array(s-1),r=1;r<s;r++)n[r-1]=arguments[r];!function(e,t,n){if(h)e.apply(t,n);else for(var r=e.length,i=_(e,r),o=0;o<r;++o)i[o].apply(t,n)}(t,this,n)}return!0},z.prototype.addListener=function(e,t){return H(this,e,t,!1)},z.prototype.on=z.prototype.addListener,z.prototype.prependListener=function(e,t){return H(this,e,t,!0)},z.prototype.once=function(e,t){if("function"!=typeof t)throw new TypeError('"listener" argument must be a function');return this.on(e,D(this,e,t)),this},z.prototype.prependOnceListener=function(e,t){if("function"!=typeof t)throw new TypeError('"listener" argument must be a function');return this.prependListener(e,D(this,e,t)),this},z.prototype.removeListener=function(e,t){var n,r,i,o,a;if("function"!=typeof t)throw new TypeError('"listener" argument must be a function');if(!(r=this._events))return this;if(!(n=r[e]))return this;if(n===t||n.listener&&n.listener===t)0==--this._eventsCount?this._events=new j:(delete r[e],r.removeListener&&this.emit("removeListener",e,n.listener||t));else if("function"!=typeof n){for(i=-1,o=n.length;0<o--;)if(n[o]===t||n[o].listener&&n[o].listener===t){a=n[o].listener,i=o;break}if(i<0)return this;if(1===n.length){if(n[0]=void 0,0==--this._eventsCount)return this._events=new j,this;delete r[e]}else!function(e){for(var t=i,n=t+1,r=e.length;n<r;t+=1,n+=1)e[t]=e[n];e.pop()}(n);r.removeListener&&this.emit("removeListener",e,a||t)}return this},z.prototype.removeAllListeners=function(e){var t,n=this._events;if(!n)return this;if(!n.removeListener)return 0===arguments.length?(this._events=new j,this._eventsCount=0):n[e]&&(0==--this._eventsCount?this._events=new j:delete n[e]),this;if(0===arguments.length){for(var r,i=Object.keys(n),o=0;o<i.length;++o)"removeListener"!==(r=i[o])&&this.removeAllListeners(r);return this.removeAllListeners("removeListener"),this._events=new j,this._eventsCount=0,this}if("function"==typeof(t=n[e]))this.removeListener(e,t);else if(t)for(;this.removeListener(e,t[t.length-1]),t[0];);return this},z.prototype.listeners=function(e){var t=this._events,n=t&&(n=t[e])?"function"==typeof n?[n.listener||n]:function(e){for(var t=new Array(e.length),n=0;n<t.length;++n)t[n]=e[n].listener||e[n];return t}(n):[];return n},z.listenerCount=function(e,t){return"function"==typeof e.listenerCount?e.listenerCount(t):F.call(e,t)},z.prototype.listenerCount=F,z.prototype.eventNames=function(){return 0<this._eventsCount?Reflect.ownKeys(this._events):[]};var V,q=function(e){return(window.devicePixelRatio||1)/(e.webkitBackingStorePixelRatio||e.mozBackingStorePixelRatio||e.msBackingStorePixelRatio||e.oBackingStorePixelRatio||e.backingStorePixelRatio||1)},Z=15,W="12px",Y=S.hsl(180,30,70),$={performance:!0},J=function(){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&a(e,t)}(c,z);var e,t,n,u=h(c);function c(e){var t=e.canvas,n=e.width,r=void 0===n?t.width:n,i=e.height,o=void 0===i?t.height:i,a=e.data,s=e.colors,h=void 0===s?{}:s,l=e.timestamps,n=void 0===l?[]:l,i=e.settings,s=void 0===i?{}:i,l=e.font,i=void 0===l?W:l,l=e.nodeHeight,e=void 0===l?Z:l;return function(e){if(!(e instanceof c))throw new TypeError("Cannot call a class as a function")}(this),(l=u.call(this)).timelineStart=0,l.timelineEnd=0,l.timelineDimension=0,l.timelineDelta=0,l.charWidth=0,l.charHeight=0,l.positionY=0,l.positionX=0,l.zoom=0,l.mouse={x:0,y:0},l.width=r,l.height=o,l.font=i,l.nodeHeight=e,l.ctx=t.getContext("2d",{alpha:!1}),l.canvas=t,l.userColors=h,l.pixelRatio=q(l.ctx),l.setSettings(s,!1),l.setTimestamps(n,!1),l.setData(a,!1),l.handleMouseWheel=l.handleMouseWheel.bind(d(l)),l.handleMouseDown=l.handleMouseDown.bind(d(l)),l.handleMouseUp=l.handleMouseUp.bind(d(l)),l.handleMouseUp=l.handleMouseUp.bind(d(l)),l.handleMouseMove=l.handleMouseMove.bind(d(l)),l.resetStorages(),l.init(),l}return e=c,(t=[{key:"init",value:function(){var e,t;this.ctx&&(this.fixBlurryFont(),t=(e=this.ctx.measureText("w")).fontBoundingBoxAscent,this.blockPadding=Math.ceil((this.nodeHeight-(t+e.fontBoundingBoxDescent))/2+e.fontBoundingBoxDescent),this.charWidth=e.width,this.charHeight=t+e.fontBoundingBoxDescent,this.headerHeight=this.nodeHeight+this.charHeight+this.blockPadding,this.ctx.font=this.font,this.clearHitRegions(),this.initView(),this.initListeners(),this.render())}},{key:"resetStorages",value:function(){this.colors={},this.lastRandomColor=Y,this.selectedRegion=null,this.hoveredRegion=null,this.lastAnimationFrame=null,this.lastUsedColor=null,this.textRenderQueue=[],this.rectRenderQueue={}}},{key:"fixBlurryFont",value:function(){this.canvas.style.overflow="hidden",this.canvas.style.width=this.width+"px",this.canvas.style.height=this.height+"px",this.canvas.width=this.width*this.pixelRatio,this.canvas.height=this.height*this.pixelRatio,this.ctx.setTransform(this.pixelRatio,0,0,this.pixelRatio,0,0)}},{key:"destroy",value:function(){this.removeListeners()}},{key:"setData",value:function(){var n,r,e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:[],t=!(1<arguments.length&&void 0!==arguments[1])||arguments[1];this.data=e,this.flatTree=(n=[],r=0,I(e,function(e,t){n.push({node:i(i({},e),{},{end:e.start+e.duration}),level:t,index:r++})}),n.sort(function(e,t){return e.level-t.level||e.start-t.start})),this.calcMinMax(),this.calcInitialZoom(),this.resetView(),this.resetStorages(),this.isPerformanceMode&&(this.metaClusterizedFlatTree=this.flatTree.reduce(function(e,t){var n=e[e.length-1],r=n&&n[n.length-1];return r&&r.node.color===t.node.color&&r.node.type===t.node.type&&r.level===t.level?n.push(t):e.push([t]),e},[]).filter(function(e){return e.length}).map(function(e){return{nodes:e}}),this.initialClusterizedFlatTree=N(this.metaClusterizedFlatTree,this.zoom,this.min,this.max),this.reclusterizeClusteredFlatTree()),t&&this.update()}},{key:"setTimestamps",value:function(e){var t=!(1<arguments.length&&void 0!==arguments[1])||arguments[1];this.timestamps=e.map(function(e){var t=e.color;return i(i({},s(e,["color"])),{},{color:new S(t).alpha(.7).rgb().toString()})}),t&&this.update()}},{key:"setSettings",value:function(e){var t=!(1<arguments.length&&void 0!==arguments[1])||arguments[1],e=i(i({},$),e);this.isPerformanceMode=e.performance,t&&this.update()}},{key:"resize",value:function(e,t){this.width=e||this.width,this.height=t||this.height,this.isPerformanceMode&&this.reclusterizeClusteredFlatTree(),this.fixBlurryFont(),this.update()}},{key:"update",value:function(){this.calcMinMax(),this.calcInitialZoom(),this.render()}},{key:"calcInitialZoom",value:function(){0<this.max-this.min?this.initialZoom=this.width/(this.max-this.min):this.initialZoom=1}},{key:"resetView",value:function(){this.setZoom(this.initialZoom),this.positionX=this.min}},{key:"initView",value:function(){this.calcInitialZoom(),this.resetView()}},{key:"initListeners",value:function(){this.canvas&&(this.canvas.addEventListener("wheel",this.handleMouseWheel),this.canvas.addEventListener("mousedown",this.handleMouseDown),this.canvas.addEventListener("mouseup",this.handleMouseUp),this.canvas.addEventListener("mouseleave",this.handleMouseUp),this.canvas.addEventListener("mousemove",this.handleMouseMove))}},{key:"removeListeners",value:function(){this.canvas&&(this.canvas.removeEventListener("wheel",this.handleMouseWheel),this.canvas.removeEventListener("mousedown",this.handleMouseDown),this.canvas.removeEventListener("mouseup",this.handleMouseUp),this.canvas.removeEventListener("mouseleave",this.handleMouseUp),this.canvas.removeEventListener("mousemove",this.handleMouseMove))}},{key:"handleMouseWheel",value:function(e){var t=e.deltaY,n=e.deltaX;e.preventDefault();var r=this.calcRealView(),i=this.positionX,e=this.zoom,n=n/this.zoom,t=t/1e3*this.zoom;this.tryToChangePosition(n),0!==(t=this.zoom-t>=this.initialZoom?t:this.zoom-this.initialZoom)&&(n=this.mouse.x/this.width,n=(r-this.width/(this.zoom-t))*n,this.setZoom(this.zoom-t),this.tryToChangePosition(n)),!this.isPerformanceMode||i===this.positionX&&e===this.zoom||this.reclusterizeClusteredFlatTree(),this.render()}},{key:"handleMouseDown",value:function(){this.moveActive=!0,this.mouseClickStartPosition={x:this.mouse.x,y:this.mouse.y}}},{key:"handleMouseUp",value:function(){this.moveActive=!1,this.mouseClickStartPosition&&this.mouseClickStartPosition.x===this.mouse.x&&this.mouseClickStartPosition.y===this.mouse.y&&this.handleRegionHit(this.mouse.x,this.mouse.y)}},{key:"handleMouseMove",value:function(e){var t,n,r=this.positionX;this.moveActive&&(t=this.mouse.y-e.offsetY,n=(this.mouse.x-e.offsetX)/this.zoom,this.tryToChangePosition(n),0<=this.positionY+t?this.positionY+=t:this.positionY=0),this.mouse.x=e.offsetX,this.mouse.y=e.offsetY;e=this.hoveredRegion;this.checkRegionHover(),this.isPerformanceMode&&r!==this.positionX&&this.reclusterizeClusteredFlatTree(),(this.moveActive||this.hoveredRegion||e&&!this.hoveredRegion)&&this.render()}},{key:"setZoom",value:function(e){this.zoom=e}},{key:"tryToChangePosition",value:function(e){var t=this.calcRealView();this.positionX+e+t<=this.max&&this.positionX+e>=this.min?this.positionX+=e:this.positionX+e<=this.min?this.positionX=this.min:this.positionX+e+t>=this.max&&(this.positionX=this.max-t)}},{key:"reclusterizeClusteredFlatTree",value:function(){var e,n,r,i;this.actualClusterizedFlatTree=(e=this.initialClusterizedFlatTree,n=this.zoom,r=this.positionX,i=this.positionX+this.calcRealView(),e.reduce(function(e,t){return B(t,r,i)&&(t.duration*n<=4?e.push(t):e.push.apply(e,f(N([t],n,r,i)))),e},[]))}},{key:"calcRealView",value:function(){return this.width/this.zoom}},{key:"calcTimeline",value:function(){var e=this.max-this.min,t=e/(this.width/90),n=this.calcRealView(),e=n/(e||1);this.timelineDelta=t/Math.pow(2,Math.floor(Math.log2(1/e))),this.timelineStart=Math.floor((this.positionX-this.min)/this.timelineDelta),this.timelineEnd=Math.ceil(n/this.timelineDelta)+this.timelineStart;n=3-Math.ceil(10*this.timelineDelta).toString().length;this.timelineDimension=0<n?n:0}},{key:"calcMinMax",value:function(){var e=this.flatTree,t=this.timestamps,n=!0,r=0,i=0;e.forEach(function(e){var t=e.node,e=t.start,t=t.end;n?(r=e,i=t,n=!1):(r=r<e?r:e,i=t<i?i:t)}),this.min=t.reduce(function(e,t){t=t.timestamp;return t<e?t:e},r),this.max=t.reduce(function(e,t){t=t.timestamp;return e<t?t:e},i)}},{key:"clearHitRegions",value:function(){this.hitRegions=[]}},{key:"addHitRegion",value:function(e,t,n,r,i,o){this.hitRegions.push({type:e,data:t,x:n,y:r,w:i,h:o})}},{key:"handleRegionHit",value:function(e,t){this.selectedRegion=this.getHoveredRegion(e,t),this.render(),this.selectedRegion&&"node"===this.selectedRegion.type&&this.handleNodeSelect(this.selectedRegion&&this.selectedRegion.data)}},{key:"handleNodeSelect",value:function(e){this.emit("select",e)}},{key:"checkRegionHover",value:function(){this.hoveredRegion=this.getHoveredRegion(this.mouse.x,this.mouse.y)}},{key:"getHoveredRegion",value:function(i,o){return this.hitRegions.find(function(e){var t=e.x,n=e.y,r=e.w,e=e.h;return t<=i&&i<=t+r&&n<=o&&o<=n+e})}},{key:"getColor",value:function(e,t){if(t)return t;if(this.colors[e])return this.colors[e];if(this.userColors[e]){t=new S(this.userColors[e]);return this.colors[e]=t.rgb().toString(),this.colors[e]}return this.lastRandomColor=this.lastRandomColor.rotate(10),this.colors[e]=this.lastRandomColor.rgb().toString(),this.colors[e]}},{key:"calcRect",value:function(e,t,n){t*=this.zoom;return{x:this.timeToPosition(e),y:n*this.nodeHeight+ +n-this.positionY+this.headerHeight,w:2<=t?t-1:t<1?1:t}}},{key:"timeToPosition",value:function(e){return e*this.zoom-this.positionX*this.zoom}},{key:"renderDetailedChart",value:function(){var s,e,t,n,h=this,l=this.width,u=this.nodeHeight,c=this.height,d=this.selectedRegion;this.flatTree.forEach(function(e){var t=e.node,n=e.level,r=t.start,i=t.duration,o=t.name,a=t.type,e=t.color,r=h.calcRect(r,i,n),i=r.x,n=r.y,r=r.w;0<i+r&&i<l&&0<n+u&&n<c&&(h.addHitRegion("node",t,i,n,r,u),d&&t===d.data&&(s={x:i,y:n,w:r}),.5<r&&h.addRectToRenderQueue(h.getColor(a,e),i,n,r),4<r&&h.addTextToRenderQueue(o,i,n,r))}),this.resolveRectRenderQueue(),this.resolveTextRenderQueue(),s&&(e=s.x,t=s.y,n=s.w,this.renderStroke(e,t,n,this.nodeHeight))}},{key:"renderBriefChart",value:function(){function a(e){var t=e.node,n=e.level,e=(r=s.calcRect(t.start,t.duration,n)).x,n=r.y,r=r.w;o&&t===o.data&&(i={x:e,y:n,w:r}),s.addHitRegion("node",t,e,n,r,l)}var i,e,t,n,s=this,h=this.width,l=this.nodeHeight,u=this.height,o=this.selectedRegion,c=this.charWidth;this.actualClusterizedFlatTree.forEach(function(e){var t=e.start,n=e.duration,r=e.type,i=e.level,o=e.nodes,e=e.color,t=s.calcRect(t,n,i),n=t.x,i=t.y,t=t.w;0<n+t&&n<h&&0<i+l&&i<u&&(o.forEach(a),.5<=t&&s.addRectToRenderQueue(s.getColor(r,e),n,i,t),c<=t&&1===o.length&&s.addTextToRenderQueue(o[0].node.name,n,i,t))}),this.resolveRectRenderQueue(),this.resolveTextRenderQueue(),i&&(e=i.x,t=i.y,n=i.w,this.renderStroke(e,t,n,this.nodeHeight))}},{key:"renderTimestamps",value:function(){var s=this;this.ctx.clearRect(0,0,this.width,this.charHeight),this.timestamps.slice().sort(function(e,t){return e.timestamp-t.timestamp}).reduce(function(e,t){var n=t.timestamp,r=t.color,i=t.shortName,o=s.ctx.measureText(i).width,a=o+2*s.blockPadding,n=s.timeToPosition(n),o=s.calcTimestampBlockPosition(n,e,o);return s.ctx.strokeStyle=r,s.ctx.beginPath(),s.ctx.setLineDash([8,7]),s.ctx.moveTo(n,0),s.ctx.lineTo(n,s.height),s.ctx.stroke(),s.setCtxColor(r),s.ctx.fillRect(o,s.charHeight,a,s.charHeight+s.blockPadding),s.setCtxColor("black"),s.ctx.fillText(i,o+s.blockPadding,2*s.charHeight),s.addHitRegion("timestamp",t,o,s.charHeight,a,s.charHeight+s.blockPadding),o+a},0)}},{key:"calcTimestampBlockPosition",value:function(e,t){return 0<e&&e<t?t:e}},{key:"forEachTime",value:function(e){for(var t=this.timelineStart;t<=this.timelineEnd;t++){var n=t*this.timelineDelta+this.min;e(this.timeToPosition(n.toFixed(this.timelineDimension)),n)}}},{key:"renderLines",value:function(t,n){var r=this;this.setCtxColor("rgb(126, 126, 126, 0.5)"),this.forEachTime(function(e){r.ctx.fillRect(e,t,1,n)})}},{key:"renderTimes",value:function(){var n=this;this.ctx.clearRect(0,0,this.width,this.charHeight),this.setCtxColor("black"),this.forEachTime(function(e,t){n.ctx.fillText(t.toFixed(n.timelineDimension)+"ms",e+n.blockPadding,n.charHeight-4)}),this.setCtxColor("rgb(126, 126, 126, 0.5)"),this.forEachTime(function(e){n.ctx.fillRect(e,0,1,n.charHeight)})}},{key:"renderStroke",value:function(e,t,n,r){this.ctx.setLineDash([]),this.ctx.strokeStyle="green",this.ctx.strokeRect(e,t,n,r)}},{key:"addRectToRenderQueue",value:function(e,t,n,r){this.rectRenderQueue[e]||(this.rectRenderQueue[e]=[]),this.rectRenderQueue[e].push({x:t,y:n,w:r})}},{key:"resolveRectRenderQueue",value:function(){var i=this;Object.entries(this.rectRenderQueue).forEach(function(e){var e=l(e,2),r=e[0];e[1].forEach(function(e){var t=e.x,n=e.y,e=e.w;return i.renderRect(r,t,n,e)})}),this.rectRenderQueue={}}},{key:"renderRect",value:function(e,t,n,r){this.setCtxColor(e),this.ctx.fillRect(t,n,r,this.nodeHeight)}},{key:"setCtxColor",value:function(e){this.lastUsedColor!==e&&(this.ctx.fillStyle=e,this.lastUsedColor=e)}},{key:"addTextToRenderQueue",value:function(e,t,n,r){!e||0<(r=r-(2*this.blockPadding-(t<0?t:0)))&&(e=e.length*this.charWidth>r?0<(r=(Math.floor(r/this.charWidth)-1)/2)?e.slice(0,Math.ceil(r))+"…"+e.slice(e.length-Math.floor(r),e.length):"":e)&&this.textRenderQueue.push({text:e,x:t,y:n})}},{key:"resolveTextRenderQueue",value:function(){var r=this;this.setCtxColor("black"),this.textRenderQueue.forEach(function(e){var t=e.text,n=e.x,e=e.y;r.ctx.fillText(t,(n<0?0:n)+r.blockPadding,e+r.nodeHeight-r.blockPadding)}),this.textRenderQueue=[]}},{key:"renderTooltip",value:function(){if(this.hoveredRegion)switch(this.hoveredRegion.type){case"node":this.renderNodeTooltip();break;case"timestamp":this.renderTimestampTooltip()}}},{key:"renderTimestampTooltip",value:function(){var e,t;this.hoveredRegion&&(e=(t=this.hoveredRegion.data).fullName,t=t.timestamp,e="".concat(e),t="".concat(t.toFixed(2)," ms"),this.renderTooltipFromData(e,[t]))}},{key:"renderNodeTooltip",value:function(){var e,t,n,r,i;this.hoveredRegion&&(i=(r=this.hoveredRegion.data).start,e=r.duration,t=r.children,n=r.name,r=e-(t?t.reduce(function(e,t){return e+t.duration},0):0),n="".concat(n),r="duration: ".concat(e.toFixed(2)," ms ").concat(t&&t.length?"(self ".concat(r.toFixed(2)," ms)"):""),i="start: ".concat(i.toFixed(2)),this.renderTooltipFromData(n,[r,i]))}},{key:"renderTooltipFromData",value:function(e,t){var n=this,r=this.mouse.x+10,i=this.mouse.y+10,o=[e].concat(f(t)).map(function(e){return n.ctx.measureText(e)}).reduce(function(e,t){t=t.width;return Math.max(e,t)},0)+2*this.blockPadding;this.ctx.shadowColor="black",this.ctx.shadowBlur=5,this.setCtxColor("white"),this.ctx.fillRect(r,i,o+2*this.blockPadding,this.charHeight*(t.length+1)+2*this.blockPadding),this.ctx.shadowColor=null,this.ctx.shadowBlur=null,this.setCtxColor("black"),this.ctx.fillText(e,r+this.blockPadding,i+this.nodeHeight-this.blockPadding),this.setCtxColor("#688f45"),t.forEach(function(e,t){t+=1;n.ctx.fillText(e,r+n.blockPadding,i+n.nodeHeight-n.blockPadding+(n.charHeight+2)*t)})}},{key:"render",value:function(){var e=this;cancelAnimationFrame(this.lastAnimationFrame),this.lastAnimationFrame=requestAnimationFrame(function(){e.ctx.clearRect(0,0,e.width,e.height),e.clearHitRegions(),e.calcTimeline(),e.renderLines(0,e.height),e.isPerformanceMode?e.renderBriefChart():e.renderDetailedChart(),e.ctx.clearRect(0,0,e.width,e.headerHeight),e.renderLines(0,e.headerHeight),e.renderTimestamps(),e.renderTimes(),e.renderTooltip()})}}])&&r(e.prototype,t),n&&r(e,n),c}(),K=function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0;return Math.floor(Math.random()*(e-t))+t},G=document.getElementById("wrapper"),ee=document.getElementById("canvas"),te=document.getElementById("selected-node"),ne=document.getElementById("button"),re=document.getElementById("start"),ie=document.getElementById("duration"),oe=document.getElementById("count"),ae=document.getElementById("levels"),se=document.getElementById("performance"),he=5e3,le=500,ue=500,ce=10,de=(ve=l(X(),2))[0],fe=ve[1],ve=location.search;ee.width=de,ee.height=fe;var me=new J({canvas:ee,data:ve?[]:U(),timestamps:[{shortName:"DCL",fullName:"DOMContentLoaded",timestamp:2e3,color:"#d7c44c"},{shortName:"LE",fullName:"LoadEvent",timestamp:2100,color:"#4fd24a"},{shortName:"TTI",fullName:"Time To Interactive",timestamp:3e3,color:"#4b7ad7"}],colors:{task:"#696969",event:"#a4775b"},settings:{performance:!0}});me.on("select",function(e){te.innerHTML=e?JSON.stringify(i(i({},e),{},{end:e.start+e.duration,children:void 0}),null,"  "):""}),window.addEventListener("resize",function(){me.resize.apply(me,f(X()))}),ne.addEventListener("click",function(){me.setData(U())}),!ve||(ve=ve.split("?").map(function(e){return e.split("=")}).reduce(function(e,t){var n=l(t,2),t=n[0],n=n[1];return e[t]=n,e},{})).file&&fetch(ve.file).then(function(e){return e.text()}).then(function(e){me.setData(JSON.parse(e)),me.resetView()}),re.value=le,ie.value=he,oe.value=ue,ae.value=ce,se.checked=!0,re.addEventListener("change",function(e){return le=parseInt(e.target.value)}),ie.addEventListener("change",function(e){return he=parseInt(e.target.value)}),oe.addEventListener("change",function(e){return ue=parseInt(e.target.value)}),ae.addEventListener("change",function(e){return ce=parseInt(e.target.value)}),se.addEventListener("change",function(e){V=e.target.checked,me.setSettings({performance:V})})}();
